


NVFORTRAN (Version     23.1)          02/24/2023  13:32:57      page 1

Switches: -noasm -nodclchk -debug -nodlines -line -list
          -idir .D[1]
          -idir .D[2]
          -idir .D[3]
          -idir .D[4]
          -idir .D[5]
          -idir .D[6]
          -idir .D[7]
          -idir .D[8]
          -idir .D[9]
          -idir .D[10]
          -idir .D[11]
          -idir .D[12]
          -idir .D[13]
          -idir .D[14]
          -idir .D[15]
          -idir .D[16]
          -idir .D[17]
          -idir .D[18]
          -idir .D[19]
          -idir .D[20]
          -idir .D[21]
          -idir .D[22]
          -idir .D[23]
          -idir .D[24]
          -idir .D[25]
          -idir .D[26]
          -idir .D[27]
          -idir .D[28]
          -idir .D[29]
          -idir .D[30]
          -idir .D[31]
          -idir .D[32]
          -idir .D[33]
          -idir .D[34]
          -idir .D[35]
          -idir .D[36]
          -idir .D[37]
          -idir .D[38]
          -idir .D[39]
          -idir .D[40]
          -idir .D[41]
          -idir .D[42]
          -idir .D[43]
          -idir .D[44]
          -idir .D[45]
          -idir .D[46]
          -idir .D[47]
          -idir .D[48]
          -idir .D[49]
          -idir .D[50]
          -idir .D[51]
          -idir .D[52]
          -idir .D[53]
          -idir .D[54]
          -idir .D[55]
          -idir .D[56]
          -idir .D[57]






NVFORTRAN (Version     23.1)          02/24/2023  13:32:57      page 2

          -idir .D[58]
          -idir .D[59]
          -idir .D[60]
          -idir .D[61]
          -idir .D[62]
          -idir .D[63]
          -idir .D[64]
          -idir .D[65]
          -idir .D[66]
          -idir .D[67]
          -idir .D[68]
          -idir .D[69]
          -idir .D[70]
          -idir .D[71]
          -idir .D[72]
          -idir .D[73]
          -idir .D[74]
          -idir .D[75]
          -idir .D[76]
          -idir .D[77]
          -idir .D[78]
          -idir /opt/softs/nvidia/hpc_sdk/Linux_x86_64/23.1/comm_libs/openmpi/openmpi-3.1.5/include
          -idir /opt/softs/nvidia/hpc_sdk/Linux_x86_64/23.1/comm_libs/openmpi/openmpi-3.1.5/lib
          -inform severe -opt 0 -nosave -object -noonetrip
          -depchk on -nostandard     
          -symbol -noupcase    

Filename: aeolusconstants.F90

(    1) MODULE AeolusConstants
(    2)   !  #[ Documentation
(    3)   !---------------------------------------------------
(    4)   ! This module introduces some constants used by the AEOLUS L2B processor
(    5)   !
(    6)   ! Written by: Paul Poli, METEO FRANCE,  10-Jun-2005
(    7)   !
(    8)   ! Modifications:
(    9)   ! 01-Sep-2005 J. de Kloe  Added software_version
(   10)   ! 12-Sep-2005 D. Tan      Software_version reduced to 0.1
(   11)   ! 28-Feb-2006 D. Tan      Software_version 0.2
(   12)   ! 03-Apr-2006 J. de Kloe  added software_ProcName 
(   13)   ! 27-Apr-2006 J. de Kloe  added software_ExecutableName 
(   14)   ! 04-May-2006 D. Tan      Software_version 01.00
(   15)   ! 22-May-2006 D. Tan      Software_version 01.10
(   16)   ! 07-Dec-2006 D. Tan      Software_version 01.20
(   17)   ! 28-Mar-2007 D. Tan      Software_version 01.30
(   18)   ! 05-Jun-2007 D. Tan      Software_version 01.31
(   19)   ! 15-Jun-2007 J. de Kloe  disabled some unused items, and added some
(   20)   !                         integer items defining the Aeolus (max) values
(   21)   !                         for Num_Meas/Num_Obs/Num_RangeBins
(   22)   ! 05-Nov-2007 J. de Kloe  added IODD version string parameters
(   23)   ! 13-Dec-2007 D. Tan      Software_version 01.32
(   24)   ! 21-Jan-2008 J. de Kloe  incremented L1B IODD version
(   25)   ! 21-Feb-2008 J. de Kloe  again incremented L1B IODD version
(   26)   !                         and made old version number available as well
(   27)   ! 22-Feb-2008 D. Tan      RBC IODD version 01.20 (not 01.02),
(   28)   !                         Ref_Doc strings.
(   29)   ! 26-Feb-2008 D. Tan      Software_version 01.33
(   30)   ! 25-Sep-2008 J. de Kloe  adapted to L1B v1.11






NVFORTRAN (Version     23.1)          02/24/2023  13:32:57      page 3

(   31)   ! 29-Sep-2008 J. de Kloe  moved RBC table settings to a new module in
(   32)   !                         RayleighBrillouinProcessing/
(   33)   !                         rbc_table_dimensions.F90
(   34)   ! 07-Nov-2008 J. de Kloe  updated to Dorits L1B product version 5.00
(   35)   ! 17-Nov-2008 J. de Kloe  adapted to L1B v1.12
(   36)   ! 16-Dec-2008 D. Tan      Software_version 01.40, IODD 01.40
(   37)   ! 26-Jan-2008 J. de Kloe  updated to Dorits L1B product versions 5.01/2
(   38)   ! 30-Apr-2009 D. Tan      Software_version 01.41, IODD remains 01.40
(   39)   ! 13-Jul-2009 J. de Kloe  updated to Dorits L1B product versions 5.03/4
(   40)   ! 25-Jan-2010 D. Tan      L2B/C IODD 01.50, Software_version remains 01.41
(   41)   ! 23-Mar-2010 J. de Kloe  added signal_unused_file string parameter
(   42)   ! 12-Apr-2010 D. Tan      Software_version 01.50
(   43)   ! 08-Jul-2010 J. de Kloe  changed value of signal_unused_file
(   44)   ! 16-Nov-2010 J. de Kloe  updated to Dorits L1B product versions 5.05/6
(   45)   ! 04-Jan-2011 J. de Kloe  updated to Dorits L1B product version 5.07
(   46)   ! 06-Apr-2011 J. de Kloe  added Ref_Doc_L1B definition
(   47)   ! 22-Jun-2011 J. de Kloe  rename software_taskname to 
(   48)   !                         software_TaskName_L2BP and add a new constant
(   49)   !                         named software_TaskName_SBRC
(   50)   ! 06-Jul-2011 J. de Kloe  remove outdated file/IODD versions
(   51)   ! 07-Jul-2011 J. de Kloe  add some constants for the AuxCal file
(   52)   ! 31-Aug-2011 J. de Kloe  move software to version 2.00
(   53)   ! 02-Nov-2011 J. de Kloe  add 2 channel parameters
(   54)   ! 03-Nov-2011 J. de Kloe  new L1B IODD version for L1B v6.00
(   55)   ! 25-Nov-2011 J. de Kloe  added Undefined_Channel parameter 
(   56)   !                         and disable N_Meas_Max_L1B
(   57)   ! 20-Mar-2012 J. de Kloe  phase out N_Obs_Max_Mie/N_Obs_Max_Rayleigh
(   58)   !                         and add ENDGRP parameters and ENDGRP_to_text()
(   59)   ! 19-Apr-2012 J. de Kloe  fix a small typo
(   60)   ! 30-Oct-2012 J. de Kloe  move to AuxRBC IODD v.2.0
(   61)   ! 28-Nov-2012 J. de Kloe  move to L2BC IODD v.2.0
(   62)   ! 20-Mar-2014 J. de Kloe  add new Taskname for L2B-to-BUFR converter
(   63)   ! 15-Apr-2014 J. de Kloe  move software to version 2.10
(   64)   ! 17-Jun-2014 J. de Kloe  new L1B IODD version 4.03
(   65)   ! 06-Feb-2015 M. Rennie   Latest laser wavelength value
(   66)   ! 19-Feb-2015 M. Rennie   move software to version 2.20
(   67)   !                         and update IODD versions
(   68)   ! 09-Mar-2015 J. de Kloe  update AuxClim IODD version
(   69)   ! 13-Jan-2015 M. Rennie   Move to AUX_RBC IODD v3.20
(   70)   ! 03-Jun-2016 J. de Kloe  move software to version 2.30
(   71)   ! 21-Jun-2016 J. de Kloe  Move to AUX_RBC schema version v3.2.0
(   72)   ! 15-Jul-2016 J. de Kloe  Move to AUX_CAL schema version v3.2
(   73)   ! 22-Jul-2016 J. de Kloe  Add iodd version for the AUX_MRC file
(   74)   ! 21-Jun-2017 J. de Kloe  move software to version 2.40 (never delivered)
(   75)   ! 14-Jul-2017 J. de Kloe  move software to version 3.00
(   76)   ! 02-Aug-2017 J. de Kloe  update iodd version for L1B and MRC file
(   77)   ! 01-Sep-2017 J. de Kloe  update iodd version for L1B file
(   78)   ! 20-Sep-2018 J. de Kloe  move software to version 3.01
(   79)   ! 11-Sep-2017 J. de Kloe  move software to version 3.10
(   80)   ! 20-Mar-2018 J. de Kloe  Add iodd version for the AUX_RDB file
(   81)   ! 03-Jul-2018 J. de Kloe  added iodd_version_aux_hbe constant
(   82)   ! 11-Sep-2018 J. de Kloe  new file formats after leap second fix
(   83)   ! 02-Oct-2018 J. de Kloe  update Ref_Doc settings and annotate them
(   84)   ! 15-Feb-2019 J. de Kloe  update IODD/schemaversions for external inputs
(   85)   ! 26-Feb-2019 J. de Kloe  define old allowed IODD/schemaversions
(   86)   !                         for some files
(   87)   !---------------------------------------------------
(   88)   !  #]






NVFORTRAN (Version     23.1)          02/24/2023  13:32:57      page 4

(   89)   !  #[ modules used
(   90)   USE Numerics, only: r8_, i2_
(   91)   !  #]
(   92)   !  #[ global constants
(   93)   IMPLICIT NONE
(   94) 
(   95)   ! Software version for the L2BP.
(   96)   ! This version is used to fill the version field in the Fixed Header
(   97)   ! when writing ee_cfi formatted output files, like the L2B 
(   98)   ! or the Aux. Met. Data output files
(   99)   character(len=*), parameter :: software_version  = "03.10"
(  100)   ! the next name is used/reported by the Logging module
(  101)   character(len=*), parameter :: software_ProcName = "L2BP"
(  102) 
(  103)   ! the name that will be used to refer to the main executable program 
(  104)   ! of the L2BP by the ThinLayer 
(  105)   character(len=*), parameter :: &
(  106)                     software_TaskName_L2BP = "IPF2B_L1B_L2B"
(  107)   character(len=*), parameter :: &
(  108)                     software_TaskName_L2B_EE2BUFR = "IPF2B_L2B2BUFR"
(  109) 
(  110)   ! Define IODD version numbers used by the current software version;
(  111)   ! these are used to identify the fileformat of input files (L1B especially)
(  112)   ! and are used to construct the namespace strings, which we
(  113)   ! have to use in the root-tag of our xml output files
(  114)   !
(  115)   ! NOTE:
(  116)   ! We use these IODD version numbers as schema versions in the top of
(  117)   ! the xml/hdr/eef files.
(  118)   ! This is not strictly correct. IODD versions may increase without changing
(  119)   ! the schemaversion for one of the files it defines (if no changes where
(  120)   ! applied in that IODD revision). Therefore these version numbers should
(  121)   ! be replaced by schema version numbers. The iodd version numbers would
(  122)   ! still be useful for filling the RefDoc field, but are no longer
(  123)   ! leading in defining the file formats.
(  124)   !
(  125)   !                                                             ! issue date
(  126)   character(len=*), parameter :: iodd_version_L1B_N   = "04.09" ! 20180909
(  127)   character(len=*), parameter :: iodd_version_L2B_N   = "03.10" ! 20190301
(  128)   character(len=*), parameter :: iodd_version_L2C_N   = iodd_version_L2B_N
(  129)   character(len=*), parameter :: iodd_version_AuxMet  = "03.10" ! 20190301
(  130)   character(len=*), parameter :: iodd_version_AuxRBC  = "4.1"   ! 20190213 (1)
(  131)   character(len=*), parameter :: iodd_version_AuxClim = "4.1"   ! 20190211 (2)
(  132)   ! AuxClim production will be taken over by the L2A team, so its
(  133)   ! definition will move to the L2A IODD (but it is not yet in there)
(  134)   ! this one is currently not used
(  135)   !character(len=*), parameter :: iodd_version_L2A_N   = "03.08" ! 20190211
(  136)   character(len=*), parameter :: iodd_version_AuxCal  = "4.1"   ! 20190213 (1)
(  137)   character(len=*), parameter :: iodd_version_AuxPar  = "03.10" ! 20190301
(  138)   character(len=*), parameter :: iodd_version_aux_mrc = "04.09" ! 20180909
(  139)   character(len=*), parameter :: iodd_version_aux_rdb = "04.09" ! 20180909
(  140)   character(len=*), parameter :: iodd_version_aux_hbe = "04.09" ! 20180909
(  141) 
(  142)   ! (1) the new AUX_RBC and AUX_CAL formats are present in the new prototype
(  143)   !     CALsuite software v4.1 released 21-Jan-2019 and its patch 1 released
(  144)   !     13-Feb-2019 but the matching IODD is not (yet) updated ...
(  145)   !
(  146)   ! (2) the new AUX_CLM format is present in the new operational






NVFORTRAN (Version     23.1)          02/24/2023  13:32:57      page 5

(  147)   !     L2AP software v3.07 released 11-Feb-2019 but no updated IODD
(  148)   !     is provided (yet)
(  149) 
(  150)   ! some old file versions that are still allowed
(  151)   character(len=*), parameter :: old_iodd_version_L1B_N   = "04.08" ! 20170823
(  152)   character(len=*), parameter :: old_iodd_version_AuxMet  = "02.20" ! 20150315
(  153)   character(len=*), parameter :: old_iodd_version_AuxRBC  = "3.2.0" ! 20160630
(  154)   character(len=*), parameter :: old_iodd_version_AuxClim = "02.30" ! 20160701
(  155)   character(len=*), parameter :: old_iodd_version_AuxCal  = "3.2"   ! 20160630
(  156)   character(len=*), parameter :: old_iodd_version_aux_mrc = "04.05" ! 20170721
(  157)   character(len=*), parameter :: old_iodd_version_aux_rdb = "04.04" ! 20150226
(  158)   character(len=*), parameter :: old_iodd_version_aux_hbe = "04.05" ! 20170721
(  159)   
(  160)   ! NEW requirement from PDGS:
(  161)   ! (see email Massimiliano.Ciccarelli@esa.int dated 6-Sep-2018)
(  162)   ! * the REF_DOC field need to point to the new IODD version,
(  163)   !   and the schema version shall be updated accordingly
(  164)   !   with the same version.
(  165)   !
(  166)   ! THEREFORE force this in the parameters below:
(  167)   
(  168)   ! Strings for the Ref_Doc tag for files we write
(  169)   character(len=*), parameter :: Ref_Doc_Root_L1B  = "L1B IODD Iss. "
(  170)   character(len=*), parameter :: Ref_Doc_Root_L2BC = "L2B/L2C IODD Iss. "
(  171)   !character(len=*), parameter :: Ref_Doc_Root_L2A  = "L2A IODD Iss. " ! not used anymore
(  172)   character(len=*), parameter :: Ref_Doc_Root_RBC  = "RBC IODD Iss. "
(  173)   character(len=*), parameter :: Ref_Doc_Root_CAL  = "CAL IODD Iss. "
(  174) 
(  175)   character(len=*), parameter :: Ref_Doc_L1B    = Ref_Doc_Root_L1B//iodd_version_L1B_N
(  176)   character(len=*), parameter :: Ref_Doc_L2BC   = Ref_Doc_Root_L2BC//iodd_version_L2B_N
(  177)   character(len=*), parameter :: Ref_Doc_AuxMet = Ref_Doc_Root_L2BC//iodd_version_AuxMet
(  178)   character(len=*), parameter :: Ref_Doc_AuxCLM = Ref_Doc_Root_L2BC//iodd_version_AuxClim
(  179)   character(len=*), parameter :: Ref_Doc_AuxCal = Ref_Doc_Root_CAL//iodd_version_AuxCal
(  180)   character(len=*), parameter :: Ref_Doc_AuxRBC = Ref_Doc_Root_RBC//iodd_version_AuxRBC
(  181)   !never used
(  182)   !character(len=*), parameter :: Ref_Doc_AuxPar = Ref_Doc_Root_L2BC//iodd_version_AuxPar
(  183) 
(  184)   ! For convenience the most recent list of reference docs:
(  185)   ! file format   reference doc/IODD
(  186)   ! ALD_U_N_2B    AE_IF_ECMWF_L2BP_001_IODD_v3.00_20170906.pdf (TO BE UPDATED)
(  187)   ! ALD_U_N_2C    ''
(  188)   ! AUX_PAR_2B    ''
(  189)   ! AUX_MET_12    ''
(  190)   ! AUX_CLM_L2    '' (to be moved to L2A IODD?)
(  191)   ! AUX_RBC_L2    has been moved to its own document:
(  192)   !               AE-TN-MFG-GS-0003_RBC_IODD_v3.2_15DEC2015.pdf
(  193)   !               (part of prototype CAL,SUITE 3.2 delivery)
(  194)   ! AUX_CAL_L2    AE-TN-MFG-L2P-CAL-004_v40_CAL_DPM_IODD_24JUL2017.pdf
(  195)   !               (part of prototype CAL.SUITE 4.0 delivery)
(  196)   ! ALD_U_N_1B    521666_IODD_4_09_Draft_1.docx (TO BE UPDATED)
(  197)   ! AUX_HBE_1B    ''
(  198)   ! AUX_RDB_1B    ''
(  199)   ! AUX_MRC_1B    ''
(  200)   
(  201)   ! a string to be copied into the filename field of the reference 
(  202)   ! DataSetDescriptors, in case the referred file was not actually
(  203)   ! used by any of the L2BP processing algorithms
(  204)   ! As agreed with C. Caspar, see his email of 27-May-2010






NVFORTRAN (Version     23.1)          02/24/2023  13:32:57      page 6

(  205)   ! titled: "AI18.1 from L2B PM #18"
(  206)   character(len=*), parameter :: signal_unused_file = "NOT USED"
(  207) 
(  208)   ! define constants to enable choosing between the 2 channels
(  209)   integer, parameter :: Undefined_Channel = 0 ! for initialisation purposes
(  210)   integer, parameter :: Mie_Channel       = 1
(  211)   integer, parameter :: Rayleigh_Channel  = 2
(  212)   ! TODO: this replaces the now obsolete definitions in
(  213)   !       L1B_SuperBRC_creation/BrcGrouping.F90
(  214)   !       BUFR_file_handling/bufr_l2b_geoloc.F90
(  215)   !       so replaces the definitions in these 2 modules
(  216)   !       with imports of the 2 parameters defined here.
(  217) 
(  218)   ! values used to indicate why a group was ended
(  219)   ! these have been moved here to allow usage from both the working_data and
(  220)   ! the brcgrouping module, without introducing circular dependencies
(  221)   integer, parameter :: ENDGRP_no_end_reached_yet  = 0 
(  222)   integer, parameter :: ENDGRP_Rangebin_Misaligned = 1
(  223)   integer, parameter :: ENDGRP_datagap_too_large   = 2
(  224)   integer, parameter :: ENDGRP_BRC_end_reached     = 3 ! only for classic mode
(  225)   integer, parameter :: ENDGRP_LATLON_missing      = 4
(  226)   integer, parameter :: ENDGRP_hor_acc_length      = 5
(  227)   integer, parameter :: ENDGRP_end_of_L1B_file     = 6
(  228)   integer, parameter :: ENDGRP_undefined           = 99 ! for init only
(  229) 
(  230)   ! define maximum values for number of range gates, measurements
(  231)   ! and observations to be used to setup the L2B datastructures
(  232)   integer(i2_), parameter :: N_range_gates      = 24 ! current used nr of gates
(  233)   
(  234)   ! some math and physics constants
(  235)   real(r8_), parameter :: pi=3.14159265358979323846264338328_r8_
(  236)   real(r8_), parameter :: lambda=354.8e-9_r8_      ! Laser wavelength [m]
(  237)   real(r8_)            :: kwvn=2._r8_*pi/lambda  ! Laser wavenumber [m^-1]
(  238)   real(r8_), parameter :: kb=1.3806503e-23_r8_   ! Boltzmann constant [J/K]
(  239)   real(r8_), parameter :: M=28.86e-3_r8_/6.022e23_r8_ 
(  240)                           ! Mass of an air molecule [kg]
(  241)   real(r8_), parameter :: c=299792458._r8_ ! speed of light
(  242)   !  #]
(  243) contains
(  244)   !---------------------------------------------------
(  245)   function ENDGRP_to_text(endgrp) result(text)
(  246)     !  #[ convert the ENDGRP code to human readable text
(  247)     integer, intent(in) :: endgrp ! input
(  248)     character(len=256)  :: text   ! output
(  249) 
(  250)     text(:) = ' '
(  251)     select case(endgrp)
(  252)     case(ENDGRP_no_end_reached_yet)
(  253)        text = "ENDGRP_no_end_reached_yet"
(  254)     case(ENDGRP_Rangebin_Misaligned)
(  255)        text = "ENDGRP_Rangebin_Misaligned"
(  256)     case(ENDGRP_datagap_too_large)
(  257)        text = "ENDGRP_datagap_too_large"
(  258)     case(ENDGRP_BRC_end_reached)
(  259)        text = "ENDGRP_BRC_end_reached"
(  260)     case(ENDGRP_LATLON_missing)
(  261)        text = "ENDGRP_LATLON_missing"
(  262)     case(ENDGRP_hor_acc_length)






NVFORTRAN (Version     23.1)          02/24/2023  13:32:57      page 7

(  263)        text = "ENDGRP_hor_acc_length"
(  264)     case(ENDGRP_end_of_L1B_file)
(  265)        text = "ENDGRP_end_of_L1B_file"
(  266)     case(ENDGRP_undefined)
(  267)        text = "ENDGRP_undefined"
(  268)     case default
(  269)        text = "[unknown code!]"
(  270)     end select
(  271) 
(  272)   end function ENDGRP_to_text
(  273)     !  #]
(  274)   !---------------------------------------------------
(  275) END Module AeolusConstants



















































NVFORTRAN (Version     23.1)          02/24/2023  13:32:57      page 8

(    1) # 1 "aeolusconstants.F90"
(    1) MODULE AeolusConstants
(    2)   !  #[ Documentation
(    3)   !---------------------------------------------------
(    4)   ! This module introduces some constants used by the AEOLUS L2B processor
(    5)   !
(    6)   ! Written by: Paul Poli, METEO FRANCE,  10-Jun-2005
(    7)   !
(    8)   ! Modifications:
(    9)   ! 01-Sep-2005 J. de Kloe  Added software_version
(   10)   ! 12-Sep-2005 D. Tan      Software_version reduced to 0.1
(   11)   ! 28-Feb-2006 D. Tan      Software_version 0.2
(   12)   ! 03-Apr-2006 J. de Kloe  added software_ProcName 
(   13)   ! 27-Apr-2006 J. de Kloe  added software_ExecutableName 
(   14)   ! 04-May-2006 D. Tan      Software_version 01.00
(   15)   ! 22-May-2006 D. Tan      Software_version 01.10
(   16)   ! 07-Dec-2006 D. Tan      Software_version 01.20
(   17)   ! 28-Mar-2007 D. Tan      Software_version 01.30
(   18)   ! 05-Jun-2007 D. Tan      Software_version 01.31
(   19)   ! 15-Jun-2007 J. de Kloe  disabled some unused items, and added some
(   20)   !                         integer items defining the Aeolus (max) values
(   21)   !                         for Num_Meas/Num_Obs/Num_RangeBins
(   22)   ! 05-Nov-2007 J. de Kloe  added IODD version string parameters
(   23)   ! 13-Dec-2007 D. Tan      Software_version 01.32
(   24)   ! 21-Jan-2008 J. de Kloe  incremented L1B IODD version
(   25)   ! 21-Feb-2008 J. de Kloe  again incremented L1B IODD version
(   26)   !                         and made old version number available as well
(   27)   ! 22-Feb-2008 D. Tan      RBC IODD version 01.20 (not 01.02),
(   28)   !                         Ref_Doc strings.
(   29)   ! 26-Feb-2008 D. Tan      Software_version 01.33
(   30)   ! 25-Sep-2008 J. de Kloe  adapted to L1B v1.11
(   31)   ! 29-Sep-2008 J. de Kloe  moved RBC table settings to a new module in
(   32)   !                         RayleighBrillouinProcessing/
(   33)   !                         rbc_table_dimensions.F90
(   34)   ! 07-Nov-2008 J. de Kloe  updated to Dorits L1B product version 5.00
(   35)   ! 17-Nov-2008 J. de Kloe  adapted to L1B v1.12
(   36)   ! 16-Dec-2008 D. Tan      Software_version 01.40, IODD 01.40
(   37)   ! 26-Jan-2008 J. de Kloe  updated to Dorits L1B product versions 5.01/2
(   38)   ! 30-Apr-2009 D. Tan      Software_version 01.41, IODD remains 01.40
(   39)   ! 13-Jul-2009 J. de Kloe  updated to Dorits L1B product versions 5.03/4
(   40)   ! 25-Jan-2010 D. Tan      L2B/C IODD 01.50, Software_version remains 01.41
(   41)   ! 23-Mar-2010 J. de Kloe  added signal_unused_file string parameter
(   42)   ! 12-Apr-2010 D. Tan      Software_version 01.50
(   43)   ! 08-Jul-2010 J. de Kloe  changed value of signal_unused_file
(   44)   ! 16-Nov-2010 J. de Kloe  updated to Dorits L1B product versions 5.05/6
(   45)   ! 04-Jan-2011 J. de Kloe  updated to Dorits L1B product version 5.07
(   46)   ! 06-Apr-2011 J. de Kloe  added Ref_Doc_L1B definition
(   47)   ! 22-Jun-2011 J. de Kloe  rename software_taskname to 
(   48)   !                         software_TaskName_L2BP and add a new constant
(   49)   !                         named software_TaskName_SBRC
(   50)   ! 06-Jul-2011 J. de Kloe  remove outdated file/IODD versions
(   51)   ! 07-Jul-2011 J. de Kloe  add some constants for the AuxCal file
(   52)   ! 31-Aug-2011 J. de Kloe  move software to version 2.00
(   53)   ! 02-Nov-2011 J. de Kloe  add 2 channel parameters
(   54)   ! 03-Nov-2011 J. de Kloe  new L1B IODD version for L1B v6.00
(   55)   ! 25-Nov-2011 J. de Kloe  added Undefined_Channel parameter 
(   56)   !                         and disable N_Meas_Max_L1B
(   57)   ! 20-Mar-2012 J. de Kloe  phase out N_Obs_Max_Mie/N_Obs_Max_Rayleigh






NVFORTRAN (Version     23.1)          02/24/2023  13:32:57      page 9

(   58)   !                         and add ENDGRP parameters and ENDGRP_to_text()
(   59)   ! 19-Apr-2012 J. de Kloe  fix a small typo
(   60)   ! 30-Oct-2012 J. de Kloe  move to AuxRBC IODD v.2.0
(   61)   ! 28-Nov-2012 J. de Kloe  move to L2BC IODD v.2.0
(   62)   ! 20-Mar-2014 J. de Kloe  add new Taskname for L2B-to-BUFR converter
(   63)   ! 15-Apr-2014 J. de Kloe  move software to version 2.10
(   64)   ! 17-Jun-2014 J. de Kloe  new L1B IODD version 4.03
(   65)   ! 06-Feb-2015 M. Rennie   Latest laser wavelength value
(   66)   ! 19-Feb-2015 M. Rennie   move software to version 2.20
(   67)   !                         and update IODD versions
(   68)   ! 09-Mar-2015 J. de Kloe  update AuxClim IODD version
(   69)   ! 13-Jan-2015 M. Rennie   Move to AUX_RBC IODD v3.20
(   70)   ! 03-Jun-2016 J. de Kloe  move software to version 2.30
(   71)   ! 21-Jun-2016 J. de Kloe  Move to AUX_RBC schema version v3.2.0
(   72)   ! 15-Jul-2016 J. de Kloe  Move to AUX_CAL schema version v3.2
(   73)   ! 22-Jul-2016 J. de Kloe  Add iodd version for the AUX_MRC file
(   74)   ! 21-Jun-2017 J. de Kloe  move software to version 2.40 (never delivered)
(   75)   ! 14-Jul-2017 J. de Kloe  move software to version 3.00
(   76)   ! 02-Aug-2017 J. de Kloe  update iodd version for L1B and MRC file
(   77)   ! 01-Sep-2017 J. de Kloe  update iodd version for L1B file
(   78)   ! 20-Sep-2018 J. de Kloe  move software to version 3.01
(   79)   ! 11-Sep-2017 J. de Kloe  move software to version 3.10
(   80)   ! 20-Mar-2018 J. de Kloe  Add iodd version for the AUX_RDB file
(   81)   ! 03-Jul-2018 J. de Kloe  added iodd_version_aux_hbe constant
(   82)   ! 11-Sep-2018 J. de Kloe  new file formats after leap second fix
(   83)   ! 02-Oct-2018 J. de Kloe  update Ref_Doc settings and annotate them
(   84)   ! 15-Feb-2019 J. de Kloe  update IODD/schemaversions for external inputs
(   85)   ! 26-Feb-2019 J. de Kloe  define old allowed IODD/schemaversions
(   86)   !                         for some files
(   87)   !---------------------------------------------------
(   88)   !  #]
(   89)   !  #[ modules used
(   90)   USE Numerics, only: r8_, i2_
(   91)   !  #]
(   92)   !  #[ global constants
(   93)   IMPLICIT NONE
(   94) # 95 "aeolusconstants.F90"
(   95)   ! Software version for the L2BP.
(   96)   ! This version is used to fill the version field in the Fixed Header
(   97)   ! when writing ee_cfi formatted output files, like the L2B 
(   98)   ! or the Aux. Met. Data output files
(   99)   character(len=*), parameter :: software_version  = "03.10"
(  100)   ! the next name is used/reported by the Logging module
(  101)   character(len=*), parameter :: software_ProcName = "L2BP"
(  102) # 103 "aeolusconstants.F90"
(  103)   ! the name that will be used to refer to the main executable program 
(  104)   ! of the L2BP by the ThinLayer 
(  105)   character(len=*), parameter :: &
(  106)                     software_TaskName_L2BP = "IPF2B_L1B_L2B"
(  107)   character(len=*), parameter :: &
(  108)                     software_TaskName_L2B_EE2BUFR = "IPF2B_L2B2BUFR"
(  109) # 110 "aeolusconstants.F90"
(  110)   ! Define IODD version numbers used by the current software version;
(  111)   ! these are used to identify the fileformat of input files (L1B especially)
(  112)   ! and are used to construct the namespace strings, which we
(  113)   ! have to use in the root-tag of our xml output files
(  114)   !
(  115)   ! NOTE:






NVFORTRAN (Version     23.1)          02/24/2023  13:32:57      page 10

(  116)   ! We use these IODD version numbers as schema versions in the top of
(  117)   ! the xml/hdr/eef files.
(  118)   ! This is not strictly correct. IODD versions may increase without changing
(  119)   ! the schemaversion for one of the files it defines (if no changes where
(  120)   ! applied in that IODD revision). Therefore these version numbers should
(  121)   ! be replaced by schema version numbers. The iodd version numbers would
(  122)   ! still be useful for filling the RefDoc field, but are no longer
(  123)   ! leading in defining the file formats.
(  124)   !
(  125)   !                                                             ! issue date
(  126)   character(len=*), parameter :: iodd_version_L1B_N   = "04.09" ! 20180909
(  127)   character(len=*), parameter :: iodd_version_L2B_N   = "03.10" ! 20190301
(  128)   character(len=*), parameter :: iodd_version_L2C_N   = iodd_version_L2B_N
(  129)   character(len=*), parameter :: iodd_version_AuxMet  = "03.10" ! 20190301
(  130)   character(len=*), parameter :: iodd_version_AuxRBC  = "4.1"   ! 20190213 (1)
(  131)   character(len=*), parameter :: iodd_version_AuxClim = "4.1"   ! 20190211 (2)
(  132)   ! AuxClim production will be taken over by the L2A team, so its
(  133)   ! definition will move to the L2A IODD (but it is not yet in there)
(  134)   ! this one is currently not used
(  135)   !character(len=*), parameter :: iodd_version_L2A_N   = "03.08" ! 20190211
(  136)   character(len=*), parameter :: iodd_version_AuxCal  = "4.1"   ! 20190213 (1)
(  137)   character(len=*), parameter :: iodd_version_AuxPar  = "03.10" ! 20190301
(  138)   character(len=*), parameter :: iodd_version_aux_mrc = "04.09" ! 20180909
(  139)   character(len=*), parameter :: iodd_version_aux_rdb = "04.09" ! 20180909
(  140)   character(len=*), parameter :: iodd_version_aux_hbe = "04.09" ! 20180909
(  141) # 142 "aeolusconstants.F90"
(  142)   ! (1) the new AUX_RBC and AUX_CAL formats are present in the new prototype
(  143)   !     CALsuite software v4.1 released 21-Jan-2019 and its patch 1 released
(  144)   !     13-Feb-2019 but the matching IODD is not (yet) updated ...
(  145)   !
(  146)   ! (2) the new AUX_CLM format is present in the new operational
(  147)   !     L2AP software v3.07 released 11-Feb-2019 but no updated IODD
(  148)   !     is provided (yet)
(  149) # 150 "aeolusconstants.F90"
(  150)   ! some old file versions that are still allowed
(  151)   character(len=*), parameter :: old_iodd_version_L1B_N   = "04.08" ! 20170823
(  152)   character(len=*), parameter :: old_iodd_version_AuxMet  = "02.20" ! 20150315
(  153)   character(len=*), parameter :: old_iodd_version_AuxRBC  = "3.2.0" ! 20160630
(  154)   character(len=*), parameter :: old_iodd_version_AuxClim = "02.30" ! 20160701
(  155)   character(len=*), parameter :: old_iodd_version_AuxCal  = "3.2"   ! 20160630
(  156)   character(len=*), parameter :: old_iodd_version_aux_mrc = "04.05" ! 20170721
(  157)   character(len=*), parameter :: old_iodd_version_aux_rdb = "04.04" ! 20150226
(  158)   character(len=*), parameter :: old_iodd_version_aux_hbe = "04.05" ! 20170721
(  159)   
(  160)   ! NEW requirement from PDGS:
(  161)   ! (see email Massimiliano.Ciccarelli@esa.int dated 6-Sep-2018)
(  162)   ! * the REF_DOC field need to point to the new IODD version,
(  163)   !   and the schema version shall be updated accordingly
(  164)   !   with the same version.
(  165)   !
(  166)   ! THEREFORE force this in the parameters below:
(  167)   
(  168)   ! Strings for the Ref_Doc tag for files we write
(  169)   character(len=*), parameter :: Ref_Doc_Root_L1B  = "L1B IODD Iss. "
(  170)   character(len=*), parameter :: Ref_Doc_Root_L2BC = "L2B/L2C IODD Iss. "
(  171)   !character(len=*), parameter :: Ref_Doc_Root_L2A  = "L2A IODD Iss. " ! not used anymore
(  172)   character(len=*), parameter :: Ref_Doc_Root_RBC  = "RBC IODD Iss. "
(  173)   character(len=*), parameter :: Ref_Doc_Root_CAL  = "CAL IODD Iss. "






NVFORTRAN (Version     23.1)          02/24/2023  13:32:57      page 11

(  174) # 175 "aeolusconstants.F90"
(  175)   character(len=*), parameter :: Ref_Doc_L1B    = Ref_Doc_Root_L1B//iodd_version_L1B_N
(  176)   character(len=*), parameter :: Ref_Doc_L2BC   = Ref_Doc_Root_L2BC//iodd_version_L2B_N
(  177)   character(len=*), parameter :: Ref_Doc_AuxMet = Ref_Doc_Root_L2BC//iodd_version_AuxMet
(  178)   character(len=*), parameter :: Ref_Doc_AuxCLM = Ref_Doc_Root_L2BC//iodd_version_AuxClim
(  179)   character(len=*), parameter :: Ref_Doc_AuxCal = Ref_Doc_Root_CAL//iodd_version_AuxCal
(  180)   character(len=*), parameter :: Ref_Doc_AuxRBC = Ref_Doc_Root_RBC//iodd_version_AuxRBC
(  181)   !never used
(  182)   !character(len=*), parameter :: Ref_Doc_AuxPar = Ref_Doc_Root_L2BC//iodd_version_AuxPar
(  183) # 184 "aeolusconstants.F90"
(  184)   ! For convenience the most recent list of reference docs:
(  185)   ! file format   reference doc/IODD
(  186)   ! ALD_U_N_2B    AE_IF_ECMWF_L2BP_001_IODD_v3.00_20170906.pdf (TO BE UPDATED)
(  187)   ! ALD_U_N_2C    ''
(  188)   ! AUX_PAR_2B    ''
(  189)   ! AUX_MET_12    ''
(  190)   ! AUX_CLM_L2    '' (to be moved to L2A IODD?)
(  191)   ! AUX_RBC_L2    has been moved to its own document:
(  192)   !               AE-TN-MFG-GS-0003_RBC_IODD_v3.2_15DEC2015.pdf
(  193)   !               (part of prototype CAL,SUITE 3.2 delivery)
(  194)   ! AUX_CAL_L2    AE-TN-MFG-L2P-CAL-004_v40_CAL_DPM_IODD_24JUL2017.pdf
(  195)   !               (part of prototype CAL.SUITE 4.0 delivery)
(  196)   ! ALD_U_N_1B    521666_IODD_4_09_Draft_1.docx (TO BE UPDATED)
(  197)   ! AUX_HBE_1B    ''
(  198)   ! AUX_RDB_1B    ''
(  199)   ! AUX_MRC_1B    ''
(  200)   
(  201)   ! a string to be copied into the filename field of the reference 
(  202)   ! DataSetDescriptors, in case the referred file was not actually
(  203)   ! used by any of the L2BP processing algorithms
(  204)   ! As agreed with C. Caspar, see his email of 27-May-2010
(  205)   ! titled: "AI18.1 from L2B PM #18"
(  206)   character(len=*), parameter :: signal_unused_file = "NOT USED"
(  207) # 208 "aeolusconstants.F90"
(  208)   ! define constants to enable choosing between the 2 channels
(  209)   integer, parameter :: Undefined_Channel = 0 ! for initialisation purposes
(  210)   integer, parameter :: Mie_Channel       = 1
(  211)   integer, parameter :: Rayleigh_Channel  = 2
(  212)   ! TODO: this replaces the now obsolete definitions in
(  213)   !       L1B_SuperBRC_creation/BrcGrouping.F90
(  214)   !       BUFR_file_handling/bufr_l2b_geoloc.F90
(  215)   !       so replaces the definitions in these 2 modules
(  216)   !       with imports of the 2 parameters defined here.
(  217) # 218 "aeolusconstants.F90"
(  218)   ! values used to indicate why a group was ended
(  219)   ! these have been moved here to allow usage from both the working_data and
(  220)   ! the brcgrouping module, without introducing circular dependencies
(  221)   integer, parameter :: ENDGRP_no_end_reached_yet  = 0 
(  222)   integer, parameter :: ENDGRP_Rangebin_Misaligned = 1
(  223)   integer, parameter :: ENDGRP_datagap_too_large   = 2
(  224)   integer, parameter :: ENDGRP_BRC_end_reached     = 3 ! only for classic mode
(  225)   integer, parameter :: ENDGRP_LATLON_missing      = 4
(  226)   integer, parameter :: ENDGRP_hor_acc_length      = 5
(  227)   integer, parameter :: ENDGRP_end_of_L1B_file     = 6
(  228)   integer, parameter :: ENDGRP_undefined           = 99 ! for init only
(  229) # 230 "aeolusconstants.F90"
(  230)   ! define maximum values for number of range gates, measurements
(  231)   ! and observations to be used to setup the L2B datastructures






NVFORTRAN (Version     23.1)          02/24/2023  13:32:57      page 12

(  232)   integer(i2_), parameter :: N_range_gates      = 24 ! current used nr of gates
(  233)   
(  234)   ! some math and physics constants
(  235)   real(r8_), parameter :: pi=3.14159265358979323846264338328_r8_
(  236)   real(r8_), parameter :: lambda=354.8e-9_r8_      ! Laser wavelength [m]
(  237)   real(r8_)            :: kwvn=2._r8_*pi/lambda  ! Laser wavenumber [m^-1]
(  238)   real(r8_), parameter :: kb=1.3806503e-23_r8_   ! Boltzmann constant [J/K]
(  239)   real(r8_), parameter :: M=28.86e-3_r8_/6.022e23_r8_ 
(  240)                           ! Mass of an air molecule [kg]
(  241)   real(r8_), parameter :: c=299792458._r8_ ! speed of light
(  242)   !  #]
(  243) contains
(  244)   !---------------------------------------------------
(  245)   function ENDGRP_to_text(endgrp) result(text)
(  246)     !  #[ convert the ENDGRP code to human readable text
(  247)     integer, intent(in) :: endgrp ! input
(  248)     character(len=256)  :: text   ! output
(  249) # 250 "aeolusconstants.F90"
(  250)     text(:) = ' '
(  251)     select case(endgrp)
(  252)     case(ENDGRP_no_end_reached_yet)
(  253)        text = "ENDGRP_no_end_reached_yet"
(  254)     case(ENDGRP_Rangebin_Misaligned)
(  255)        text = "ENDGRP_Rangebin_Misaligned"
(  256)     case(ENDGRP_datagap_too_large)
(  257)        text = "ENDGRP_datagap_too_large"
(  258)     case(ENDGRP_BRC_end_reached)
(  259)        text = "ENDGRP_BRC_end_reached"
(  260)     case(ENDGRP_LATLON_missing)
(  261)        text = "ENDGRP_LATLON_missing"
(  262)     case(ENDGRP_hor_acc_length)
(  263)        text = "ENDGRP_hor_acc_length"
(  264)     case(ENDGRP_end_of_L1B_file)
(  265)        text = "ENDGRP_end_of_L1B_file"
(  266)     case(ENDGRP_undefined)
(  267)        text = "ENDGRP_undefined"
(  268)     case default
(  269)        text = "[unknown code!]"
(  270)     end select
(  271) # 272 "aeolusconstants.F90"
(  272)   end function ENDGRP_to_text
(  273)     !  #]
(  274)   !---------------------------------------------------
(  275) END Module AeolusConstants
