


NVFORTRAN (Version     23.1)          02/24/2023  13:58:10      page 1

Switches: -noasm -nodclchk -debug -nodlines -line -list
          -idir .D[1]
          -idir .D[2]
          -idir .D[3]
          -idir .D[4]
          -idir .D[5]
          -idir .D[6]
          -idir .D[7]
          -idir .D[8]
          -idir .D[9]
          -idir .D[10]
          -idir .D[11]
          -idir .D[12]
          -idir .D[13]
          -idir .D[14]
          -idir .D[15]
          -idir .D[16]
          -idir .D[17]
          -idir .D[18]
          -idir .D[19]
          -idir .D[20]
          -idir .D[21]
          -idir .D[22]
          -idir .D[23]
          -idir .D[24]
          -idir .D[25]
          -idir .D[26]
          -idir .D[27]
          -idir .D[28]
          -idir .D[29]
          -idir .D[30]
          -idir .D[31]
          -idir .D[32]
          -idir .D[33]
          -idir .D[34]
          -idir .D[35]
          -idir .D[36]
          -idir .D[37]
          -idir .D[38]
          -idir .D[39]
          -idir .D[40]
          -idir .D[41]
          -idir .D[42]
          -idir .D[43]
          -idir .D[44]
          -idir .D[45]
          -idir .D[46]
          -idir .D[47]
          -idir .D[48]
          -idir .D[49]
          -idir .D[50]
          -idir .D[51]
          -idir .D[52]
          -idir .D[53]
          -idir .D[54]
          -idir .D[55]
          -idir .D[56]
          -idir .D[57]






NVFORTRAN (Version     23.1)          02/24/2023  13:58:10      page 2

          -idir .D[58]
          -idir .D[59]
          -idir .D[60]
          -idir .D[61]
          -idir .D[62]
          -idir .D[63]
          -idir .D[64]
          -idir .D[65]
          -idir .D[66]
          -idir .D[67]
          -idir .D[68]
          -idir .D[69]
          -idir .D[70]
          -idir .D[71]
          -idir .D[72]
          -idir .D[73]
          -idir .D[74]
          -idir .D[75]
          -idir .D[76]
          -idir .D[77]
          -idir .D[78]
          -idir /opt/softs/nvidia/hpc_sdk/Linux_x86_64/23.1/comm_libs/openmpi/openmpi-3.1.5/include
          -idir /opt/softs/nvidia/hpc_sdk/Linux_x86_64/23.1/comm_libs/openmpi/openmpi-3.1.5/lib
          -inform severe -opt 0 -nosave -object -noonetrip
          -depchk on -nostandard     
          -symbol -noupcase    

Filename: modi_teb_garden.F90

(    1) !depfile:teb_garden.F90
(    2) MODULE MODI_TEB_GARDEN 
(    3) INTERFACE
(    4)     SUBROUTINE TEB_GARDEN (DTCO, G, TOP, T, BOP, B, TPN, TIR, DMT, AT, GDM, GRM, KTEB_P,              &
(    5)                            HIMPLICIT_WIND, PTSUN, PT_CAN, PQ_CAN, PU_CAN, PT_LOWCAN, PQ_LOWCAN,   &
(    6)                            PU_LOWCAN, PZ_LOWCAN, PPEW_A_COEF, PPEW_B_COEF, PPEW_A_COEF_LOWCAN,    &
(    7)                            PPEW_B_COEF_LOWCAN, PPS, PPA, PEXNS, PEXNA, PTA, PQA, PRHOA, PCO2,     &
(    8)                            PLW_RAD, PDIR_SW, PSCA_SW, PSW_BANDS, KSW, PZENITH, PAZIM, PRR, PSR,   &
(    9)                            PZREF, PUREF, PVMOD, PH_TRAFFIC, PLE_TRAFFIC, PTSTEP, PLEW_RF, PLEW_RD,&
(   10)                            PLE_WL_A, PLE_WL_B, PRNSN_RF, PHSN_RF, PLESN_RF, PGSN_RF, PMELT_RF,    &
(   11)                            PRNSN_RD, PHSN_RD, PLESN_RD, PGSN_RD, PMELT_RD, PRN_GRND, PH_GRND,     &
(   12)                            PLE_GRND, PGFLX_GRND, PRN_TWN, PH_TWN, PLE_TWN, PGFLX_TWN, PEVAP_TWN,  &
(   13)                            PSFCO2, PUW_GRND, PUW_RF, PDUWDU_GRND, PDUWDU_RF,                      &
(   14)                            PUSTAR_TWN, PCD, PCDN, PCH_TWN, PRI_TWN, PTS_TWN, PEMIS_TWN,           &
(   15)                            PDIR_ALB_TWN, PSCA_ALB_TWN, PRESA_TWN, PAC_RD, PAC_GD, PAC_GR,         &
(   16)                            PAC_RD_WAT, PAC_GD_WAT, PAC_GR_WAT, KDAY, PEMIT_LW_FAC, PEMIT_LW_GRND, &
(   17)                            PT_RAD_IND, PREF_SW_GRND, PREF_SW_FAC, PHU_BLD, PTIME, PPROD_BLD  )
(   18) USE MODD_DATA_COVER_n, ONLY : DATA_COVER_t
(   19) USE MODD_SFX_GRID_n, ONLY : GRID_t
(   20) USE MODD_TEB_OPTION_n, ONLY : TEB_OPTIONS_t
(   21) USE MODD_TEB_n, ONLY : TEB_t
(   22) USE MODD_BEM_OPTION_n, ONLY : BEM_OPTIONS_t
(   23) USE MODD_BEM_n, ONLY : BEM_t
(   24) USE MODD_TEB_PANEL_n, ONLY : TEB_PANEL_t
(   25) USE MODD_TEB_IRRIG_n, ONLY : TEB_IRRIG_t
(   26) USE MODD_DIAG_MISC_TEB_n, ONLY : DIAG_MISC_TEB_t
(   27) USE MODD_SURFEX_n, ONLY : TEB_GARDEN_MODEL_t
(   28) USE MODD_SURFEX_n, ONLY : TEB_GREENROOF_MODEL_t
(   29) USE MODD_SURF_ATM_TURB_n, ONLY : SURF_ATM_TURB_t
(   30) TYPE(DATA_COVER_t), INTENT(INOUT) :: DTCO






NVFORTRAN (Version     23.1)          02/24/2023  13:58:10      page 3

(   31) TYPE(GRID_t), INTENT(INOUT) :: G
(   32) TYPE(TEB_OPTIONS_t), INTENT(INOUT) :: TOP
(   33) TYPE(TEB_t), INTENT(INOUT) :: T
(   34) TYPE(BEM_OPTIONS_t), INTENT(INOUT) :: BOP
(   35) TYPE(BEM_t), INTENT(INOUT) :: B
(   36) TYPE(TEB_PANEL_t), INTENT(INOUT) :: TPN
(   37) TYPE(TEB_IRRIG_t), INTENT(INOUT) :: TIR
(   38) TYPE(DIAG_MISC_TEB_t), INTENT(INOUT) :: DMT
(   39) TYPE(SURF_ATM_TURB_t), INTENT(IN) :: AT         ! atmospheric turbulence parameters
(   40) TYPE(TEB_GARDEN_MODEL_t), INTENT(INOUT) :: GDM
(   41) TYPE(TEB_GREENROOF_MODEL_t), INTENT(INOUT) :: GRM
(   42) INTEGER, INTENT(IN) :: KTEB_P                             ! TEB current patch number 
(   43)  CHARACTER(LEN=*),     INTENT(IN)  :: HIMPLICIT_WIND      ! wind implicitation option
(   44) REAL, DIMENSION(:),   INTENT(IN)    :: PTSUN              ! solar time   (s from midnight)
(   45) REAL, DIMENSION(:)  , INTENT(INOUT) :: PT_CAN             ! canyon air temperature
(   46) REAL, DIMENSION(:)  , INTENT(INOUT) :: PQ_CAN             ! canyon air specific humidity
(   47) REAL, DIMENSION(:)  , INTENT(IN)    :: PU_CAN             ! canyon hor. wind
(   48) REAL, DIMENSION(:)  , INTENT(IN)    :: PU_LOWCAN          ! wind near the road
(   49) REAL, DIMENSION(:)  , INTENT(IN)    :: PT_LOWCAN          ! temp. near the road
(   50) REAL, DIMENSION(:)  , INTENT(IN)    :: PQ_LOWCAN          ! hum. near the road
(   51) REAL, DIMENSION(:)  , INTENT(IN)    :: PZ_LOWCAN          ! height of atm. var. near the road
(   52) REAL, DIMENSION(:)  , INTENT(IN)    :: PPEW_A_COEF        ! implicit coefficients
(   53) REAL, DIMENSION(:)  , INTENT(IN)    :: PPEW_B_COEF        ! for wind coupling
(   54) REAL, DIMENSION(:)  , INTENT(IN)    :: PPEW_A_COEF_LOWCAN ! implicit coefficients for wind coupling
(   55) REAL, DIMENSION(:)  , INTENT(IN)    :: PPEW_B_COEF_LOWCAN ! between low canyon wind and road
(   56) REAL, DIMENSION(:)  , INTENT(IN)    :: PPS                ! pressure at the surface
(   57) REAL, DIMENSION(:)  , INTENT(IN)    :: PPA                ! pressure at the first atmospheric level
(   58) REAL, DIMENSION(:)  , INTENT(IN)    :: PEXNS              ! surface exner function
(   59) REAL, DIMENSION(:)  , INTENT(IN)    :: PTA                ! temperature at the lowest level
(   60) REAL, DIMENSION(:)  , INTENT(IN)    :: PQA                ! specific humidity at the lowest level
(   61) REAL, DIMENSION(:)  , INTENT(IN)    :: PVMOD              ! module of the horizontal wind
(   62) REAL, DIMENSION(:)  , INTENT(IN)    :: PEXNA              ! exner function at the lowest level
(   63) REAL, DIMENSION(:)  , INTENT(IN)    :: PRHOA              ! air density at the lowest level
(   64) REAL, DIMENSION(:)  , INTENT(IN)    :: PCO2               ! CO2 concentration in the air    (kg/m3)
(   65) REAL, DIMENSION(:)  , INTENT(IN)    :: PLW_RAD            ! atmospheric infrared radiation
(   66) REAL, DIMENSION(:,:), INTENT(IN)    :: PDIR_SW            ! incoming direct solar rad on an horizontal surface
(   67) REAL, DIMENSION(:,:), INTENT(IN)    :: PSCA_SW            ! scattered incoming solar rad.
(   68) REAL, DIMENSION(:)  , INTENT(IN)    :: PSW_BANDS          ! mean wavelength of each shortwave band (m)
(   69) INTEGER,              INTENT(IN)    :: KSW                ! number of short-wave spectral bands
(   70) REAL, DIMENSION(:)  , INTENT(IN)    :: PZENITH            ! solar zenithal angle
(   71) REAL, DIMENSION(:)  , INTENT(IN)    :: PAZIM              ! solar azimuthal angle
(   72) REAL, DIMENSION(:)  , INTENT(IN)    :: PRR                ! rain rate
(   73) REAL, DIMENSION(:)  , INTENT(IN)    :: PSR                ! snow rate
(   74) REAL, DIMENSION(:)  , INTENT(IN)    :: PH_TRAFFIC         ! anthropogenic sensible heat fluxes due to traffic
(   75) REAL, DIMENSION(:)  , INTENT(IN)    :: PLE_TRAFFIC        ! anthropogenic latent heat fluxes due to traffic
(   76) REAL, DIMENSION(:)  , INTENT(IN)    :: PZREF              ! reference height of the first atm level (temperature)
(   77) REAL, DIMENSION(:)  , INTENT(IN)    :: PUREF              ! reference height of the first atm level (wind)
(   78) REAL                , INTENT(IN)    :: PTSTEP             ! time step
(   79) REAL, DIMENSION(:)  , INTENT(OUT)   :: PLEW_RF          ! latent heat flux over roof (snow)
(   80) REAL, DIMENSION(:)  , INTENT(OUT)   :: PLEW_RD          ! latent heat flux over road (snow)
(   81) REAL, DIMENSION(:)  , INTENT(OUT)   :: PLE_WL_A         ! latent heat flux over wall
(   82) REAL, DIMENSION(:)  , INTENT(OUT)   :: PLE_WL_B         ! latent heat flux over wall
(   83) REAL, DIMENSION(:)  , INTENT(OUT)   :: PRNSN_RF       ! net radiation over snow
(   84) REAL, DIMENSION(:)  , INTENT(OUT)   :: PHSN_RF        ! sensible heat flux over snow
(   85) REAL, DIMENSION(:)  , INTENT(OUT)   :: PLESN_RF       ! latent heat flux over snow
(   86) REAL, DIMENSION(:)  , INTENT(OUT)   :: PGSN_RF        ! flux under the snow
(   87) REAL, DIMENSION(:)  , INTENT(OUT)   :: PMELT_RF         ! snow melt
(   88) REAL, DIMENSION(:)  , INTENT(OUT)   :: PRNSN_RD       ! net radiation over snow






NVFORTRAN (Version     23.1)          02/24/2023  13:58:10      page 4

(   89) REAL, DIMENSION(:)  , INTENT(OUT)   :: PHSN_RD        ! sensible heat flux over snow
(   90) REAL, DIMENSION(:)  , INTENT(OUT)   :: PLESN_RD       ! latent heat flux over snow
(   91) REAL, DIMENSION(:)  , INTENT(OUT)   :: PGSN_RD        ! flux under the snow
(   92) REAL, DIMENSION(:)  , INTENT(OUT)   :: PMELT_RD       ! snow melt
(   93) REAL, DIMENSION(:)  , INTENT(OUT)   :: PRN_GRND          ! net radiation over ground
(   94) REAL, DIMENSION(:)  , INTENT(OUT)   :: PH_GRND           ! sensible heat flux over ground
(   95) REAL, DIMENSION(:)  , INTENT(OUT)   :: PLE_GRND          ! latent heat flux over ground
(   96) REAL, DIMENSION(:)  , INTENT(OUT)   :: PGFLX_GRND        ! flux through the ground
(   97) REAL, DIMENSION(:)  , INTENT(OUT)   :: PRN_TWN           ! net radiation over town
(   98) REAL, DIMENSION(:)  , INTENT(OUT)   :: PH_TWN            ! sensible heat flux over town
(   99) REAL, DIMENSION(:)  , INTENT(OUT)   :: PLE_TWN           ! latent heat flux over town
(  100) REAL, DIMENSION(:)  , INTENT(OUT)   :: PGFLX_TWN         ! flux through the ground
(  101) REAL, DIMENSION(:)  , INTENT(OUT)   :: PEVAP_TWN         ! evaporation flux (kg/m2/s)
(  102) REAL, DIMENSION(:)  , INTENT(OUT)   :: PSFCO2            ! flux of CO2       (m/s*kg_CO2/kg_air)
(  103) REAL, DIMENSION(:)  , INTENT(OUT)   :: PUW_GRND          ! momentum flux for ground built surf
(  104) REAL, DIMENSION(:)  , INTENT(OUT)   :: PUW_RF            ! momentum flux for roofs
(  105) REAL, DIMENSION(:)  , INTENT(OUT)   :: PDUWDU_GRND       !
(  106) REAL, DIMENSION(:)  , INTENT(OUT)   :: PDUWDU_RF         !
(  107) REAL, DIMENSION(:)  , INTENT(OUT)   :: PUSTAR_TWN        ! friciton velocity over town
(  108) REAL, DIMENSION(:)  , INTENT(OUT)   :: PCD               ! town averaged drag coefficient
(  109) REAL, DIMENSION(:)  , INTENT(OUT)   :: PCDN              ! town averaged neutral drag coefficient
(  110) REAL, DIMENSION(:)  , INTENT(OUT)   :: PCH_TWN           ! town averaged heat transfer coefficient
(  111) REAL, DIMENSION(:)  , INTENT(OUT)   :: PRI_TWN           ! town averaged Richardson number
(  112) REAL, DIMENSION(:)  , INTENT(OUT)   :: PTS_TWN           ! town surface temperature
(  113) REAL, DIMENSION(:)  , INTENT(OUT)   :: PEMIS_TWN         ! town equivalent emissivity
(  114) REAL, DIMENSION(:)  , INTENT(OUT)   :: PDIR_ALB_TWN      ! town equivalent direct albedo
(  115) REAL, DIMENSION(:)  , INTENT(OUT)   :: PSCA_ALB_TWN      ! town equivalent diffuse albedo
(  116) REAL, DIMENSION(:)  , INTENT(OUT)   :: PRESA_TWN         ! town aerodynamical resistance
(  117) REAL, DIMENSION(:)  , INTENT(OUT)   :: PAC_RD            ! road conductance
(  118) REAL, DIMENSION(:)  , INTENT(OUT)   :: PAC_GD            ! green area conductance
(  119) REAL, DIMENSION(:)  , INTENT(OUT)   :: PAC_GR            ! green roof conductance
(  120) REAL, DIMENSION(:)  , INTENT(OUT)   :: PAC_RD_WAT        ! road conductance for latent heat
(  121) REAL, DIMENSION(:)  , INTENT(OUT)   :: PAC_GD_WAT        ! green area conductance for latent heat
(  122) REAL, DIMENSION(:)  , INTENT(OUT)   :: PAC_GR_WAT        ! green roof conductance for latent heat
(  123) INTEGER             , INTENT(IN)    :: KDAY               ! Simulation day
(  124) REAL, DIMENSION(:)  , INTENT(OUT)    :: PEMIT_LW_GRND     ! LW flux emitted by the ground (W/m2 ground)
(  125) REAL, DIMENSION(:)  , INTENT(OUT)    :: PEMIT_LW_FAC      ! LW flux emitted by the facade (W/m2 ground)
(  126) REAL, DIMENSION(:)  , INTENT(OUT)    :: PT_RAD_IND        ! Indoor mean radiant temperature [K]
(  127) REAL, DIMENSION(:)  , INTENT(OUT)    :: PREF_SW_GRND      ! total solar rad reflected from ground
(  128) REAL, DIMENSION(:)  , INTENT(OUT)    :: PREF_SW_FAC       ! total solar rad reflected from facade
(  129) REAL, DIMENSION(:)  , INTENT(OUT)    :: PHU_BLD           ! Indoor relative humidity 0 < (-) < 1
(  130) REAL                , INTENT(IN)     :: PTIME             ! current time since midnight (UTC, s)
(  131) REAL, DIMENSION(:),   INTENT(OUT)     :: PPROD_BLD        ! Averaged     Energy production of solar panel on roofs (W/m2 bld
(  132) END SUBROUTINE TEB_GARDEN
(  133) 
(  134) END INTERFACE
(  135) END MODULE MODI_TEB_GARDEN 

















NVFORTRAN (Version     23.1)          02/24/2023  13:58:10      page 5

(    1) # 1 "modi_teb_garden.F90"
(    1) !depfile:teb_garden.F90
(    2) MODULE MODI_TEB_GARDEN 
(    3) INTERFACE
(    4)     SUBROUTINE TEB_GARDEN (DTCO, G, TOP, T, BOP, B, TPN, TIR, DMT, AT, GDM, GRM, KTEB_P,              &
(    5)                            HIMPLICIT_WIND, PTSUN, PT_CAN, PQ_CAN, PU_CAN, PT_LOWCAN, PQ_LOWCAN,   &
(    6)                            PU_LOWCAN, PZ_LOWCAN, PPEW_A_COEF, PPEW_B_COEF, PPEW_A_COEF_LOWCAN,    &
(    7)                            PPEW_B_COEF_LOWCAN, PPS, PPA, PEXNS, PEXNA, PTA, PQA, PRHOA, PCO2,     &
(    8)                            PLW_RAD, PDIR_SW, PSCA_SW, PSW_BANDS, KSW, PZENITH, PAZIM, PRR, PSR,   &
(    9)                            PZREF, PUREF, PVMOD, PH_TRAFFIC, PLE_TRAFFIC, PTSTEP, PLEW_RF, PLEW_RD,&
(   10)                            PLE_WL_A, PLE_WL_B, PRNSN_RF, PHSN_RF, PLESN_RF, PGSN_RF, PMELT_RF,    &
(   11)                            PRNSN_RD, PHSN_RD, PLESN_RD, PGSN_RD, PMELT_RD, PRN_GRND, PH_GRND,     &
(   12)                            PLE_GRND, PGFLX_GRND, PRN_TWN, PH_TWN, PLE_TWN, PGFLX_TWN, PEVAP_TWN,  &
(   13)                            PSFCO2, PUW_GRND, PUW_RF, PDUWDU_GRND, PDUWDU_RF,                      &
(   14)                            PUSTAR_TWN, PCD, PCDN, PCH_TWN, PRI_TWN, PTS_TWN, PEMIS_TWN,           &
(   15)                            PDIR_ALB_TWN, PSCA_ALB_TWN, PRESA_TWN, PAC_RD, PAC_GD, PAC_GR,         &
(   16)                            PAC_RD_WAT, PAC_GD_WAT, PAC_GR_WAT, KDAY, PEMIT_LW_FAC, PEMIT_LW_GRND, &
(   17)                            PT_RAD_IND, PREF_SW_GRND, PREF_SW_FAC, PHU_BLD, PTIME, PPROD_BLD  )
(   18) USE MODD_DATA_COVER_n, ONLY : DATA_COVER_t
(   19) USE MODD_SFX_GRID_n, ONLY : GRID_t
(   20) USE MODD_TEB_OPTION_n, ONLY : TEB_OPTIONS_t
(   21) USE MODD_TEB_n, ONLY : TEB_t
(   22) USE MODD_BEM_OPTION_n, ONLY : BEM_OPTIONS_t
(   23) USE MODD_BEM_n, ONLY : BEM_t
(   24) USE MODD_TEB_PANEL_n, ONLY : TEB_PANEL_t
(   25) USE MODD_TEB_IRRIG_n, ONLY : TEB_IRRIG_t
(   26) USE MODD_DIAG_MISC_TEB_n, ONLY : DIAG_MISC_TEB_t
(   27) USE MODD_SURFEX_n, ONLY : TEB_GARDEN_MODEL_t
(   28) USE MODD_SURFEX_n, ONLY : TEB_GREENROOF_MODEL_t
(   29) USE MODD_SURF_ATM_TURB_n, ONLY : SURF_ATM_TURB_t
(   30) TYPE(DATA_COVER_t), INTENT(INOUT) :: DTCO
(   31) TYPE(GRID_t), INTENT(INOUT) :: G
(   32) TYPE(TEB_OPTIONS_t), INTENT(INOUT) :: TOP
(   33) TYPE(TEB_t), INTENT(INOUT) :: T
(   34) TYPE(BEM_OPTIONS_t), INTENT(INOUT) :: BOP
(   35) TYPE(BEM_t), INTENT(INOUT) :: B
(   36) TYPE(TEB_PANEL_t), INTENT(INOUT) :: TPN
(   37) TYPE(TEB_IRRIG_t), INTENT(INOUT) :: TIR
(   38) TYPE(DIAG_MISC_TEB_t), INTENT(INOUT) :: DMT
(   39) TYPE(SURF_ATM_TURB_t), INTENT(IN) :: AT         ! atmospheric turbulence parameters
(   40) TYPE(TEB_GARDEN_MODEL_t), INTENT(INOUT) :: GDM
(   41) TYPE(TEB_GREENROOF_MODEL_t), INTENT(INOUT) :: GRM
(   42) INTEGER, INTENT(IN) :: KTEB_P                             ! TEB current patch number 
(   43)  CHARACTER(LEN=*),     INTENT(IN)  :: HIMPLICIT_WIND      ! wind implicitation option
(   44) REAL, DIMENSION(:),   INTENT(IN)    :: PTSUN              ! solar time   (s from midnight)
(   45) REAL, DIMENSION(:)  , INTENT(INOUT) :: PT_CAN             ! canyon air temperature
(   46) REAL, DIMENSION(:)  , INTENT(INOUT) :: PQ_CAN             ! canyon air specific humidity
(   47) REAL, DIMENSION(:)  , INTENT(IN)    :: PU_CAN             ! canyon hor. wind
(   48) REAL, DIMENSION(:)  , INTENT(IN)    :: PU_LOWCAN          ! wind near the road
(   49) REAL, DIMENSION(:)  , INTENT(IN)    :: PT_LOWCAN          ! temp. near the road
(   50) REAL, DIMENSION(:)  , INTENT(IN)    :: PQ_LOWCAN          ! hum. near the road
(   51) REAL, DIMENSION(:)  , INTENT(IN)    :: PZ_LOWCAN          ! height of atm. var. near the road
(   52) REAL, DIMENSION(:)  , INTENT(IN)    :: PPEW_A_COEF        ! implicit coefficients
(   53) REAL, DIMENSION(:)  , INTENT(IN)    :: PPEW_B_COEF        ! for wind coupling
(   54) REAL, DIMENSION(:)  , INTENT(IN)    :: PPEW_A_COEF_LOWCAN ! implicit coefficients for wind coupling
(   55) REAL, DIMENSION(:)  , INTENT(IN)    :: PPEW_B_COEF_LOWCAN ! between low canyon wind and road
(   56) REAL, DIMENSION(:)  , INTENT(IN)    :: PPS                ! pressure at the surface
(   57) REAL, DIMENSION(:)  , INTENT(IN)    :: PPA                ! pressure at the first atmospheric level






NVFORTRAN (Version     23.1)          02/24/2023  13:58:10      page 6

(   58) REAL, DIMENSION(:)  , INTENT(IN)    :: PEXNS              ! surface exner function
(   59) REAL, DIMENSION(:)  , INTENT(IN)    :: PTA                ! temperature at the lowest level
(   60) REAL, DIMENSION(:)  , INTENT(IN)    :: PQA                ! specific humidity at the lowest level
(   61) REAL, DIMENSION(:)  , INTENT(IN)    :: PVMOD              ! module of the horizontal wind
(   62) REAL, DIMENSION(:)  , INTENT(IN)    :: PEXNA              ! exner function at the lowest level
(   63) REAL, DIMENSION(:)  , INTENT(IN)    :: PRHOA              ! air density at the lowest level
(   64) REAL, DIMENSION(:)  , INTENT(IN)    :: PCO2               ! CO2 concentration in the air    (kg/m3)
(   65) REAL, DIMENSION(:)  , INTENT(IN)    :: PLW_RAD            ! atmospheric infrared radiation
(   66) REAL, DIMENSION(:,:), INTENT(IN)    :: PDIR_SW            ! incoming direct solar rad on an horizontal surface
(   67) REAL, DIMENSION(:,:), INTENT(IN)    :: PSCA_SW            ! scattered incoming solar rad.
(   68) REAL, DIMENSION(:)  , INTENT(IN)    :: PSW_BANDS          ! mean wavelength of each shortwave band (m)
(   69) INTEGER,              INTENT(IN)    :: KSW                ! number of short-wave spectral bands
(   70) REAL, DIMENSION(:)  , INTENT(IN)    :: PZENITH            ! solar zenithal angle
(   71) REAL, DIMENSION(:)  , INTENT(IN)    :: PAZIM              ! solar azimuthal angle
(   72) REAL, DIMENSION(:)  , INTENT(IN)    :: PRR                ! rain rate
(   73) REAL, DIMENSION(:)  , INTENT(IN)    :: PSR                ! snow rate
(   74) REAL, DIMENSION(:)  , INTENT(IN)    :: PH_TRAFFIC         ! anthropogenic sensible heat fluxes due to traffic
(   75) REAL, DIMENSION(:)  , INTENT(IN)    :: PLE_TRAFFIC        ! anthropogenic latent heat fluxes due to traffic
(   76) REAL, DIMENSION(:)  , INTENT(IN)    :: PZREF              ! reference height of the first atm level (temperature)
(   77) REAL, DIMENSION(:)  , INTENT(IN)    :: PUREF              ! reference height of the first atm level (wind)
(   78) REAL                , INTENT(IN)    :: PTSTEP             ! time step
(   79) REAL, DIMENSION(:)  , INTENT(OUT)   :: PLEW_RF          ! latent heat flux over roof (snow)
(   80) REAL, DIMENSION(:)  , INTENT(OUT)   :: PLEW_RD          ! latent heat flux over road (snow)
(   81) REAL, DIMENSION(:)  , INTENT(OUT)   :: PLE_WL_A         ! latent heat flux over wall
(   82) REAL, DIMENSION(:)  , INTENT(OUT)   :: PLE_WL_B         ! latent heat flux over wall
(   83) REAL, DIMENSION(:)  , INTENT(OUT)   :: PRNSN_RF       ! net radiation over snow
(   84) REAL, DIMENSION(:)  , INTENT(OUT)   :: PHSN_RF        ! sensible heat flux over snow
(   85) REAL, DIMENSION(:)  , INTENT(OUT)   :: PLESN_RF       ! latent heat flux over snow
(   86) REAL, DIMENSION(:)  , INTENT(OUT)   :: PGSN_RF        ! flux under the snow
(   87) REAL, DIMENSION(:)  , INTENT(OUT)   :: PMELT_RF         ! snow melt
(   88) REAL, DIMENSION(:)  , INTENT(OUT)   :: PRNSN_RD       ! net radiation over snow
(   89) REAL, DIMENSION(:)  , INTENT(OUT)   :: PHSN_RD        ! sensible heat flux over snow
(   90) REAL, DIMENSION(:)  , INTENT(OUT)   :: PLESN_RD       ! latent heat flux over snow
(   91) REAL, DIMENSION(:)  , INTENT(OUT)   :: PGSN_RD        ! flux under the snow
(   92) REAL, DIMENSION(:)  , INTENT(OUT)   :: PMELT_RD       ! snow melt
(   93) REAL, DIMENSION(:)  , INTENT(OUT)   :: PRN_GRND          ! net radiation over ground
(   94) REAL, DIMENSION(:)  , INTENT(OUT)   :: PH_GRND           ! sensible heat flux over ground
(   95) REAL, DIMENSION(:)  , INTENT(OUT)   :: PLE_GRND          ! latent heat flux over ground
(   96) REAL, DIMENSION(:)  , INTENT(OUT)   :: PGFLX_GRND        ! flux through the ground
(   97) REAL, DIMENSION(:)  , INTENT(OUT)   :: PRN_TWN           ! net radiation over town
(   98) REAL, DIMENSION(:)  , INTENT(OUT)   :: PH_TWN            ! sensible heat flux over town
(   99) REAL, DIMENSION(:)  , INTENT(OUT)   :: PLE_TWN           ! latent heat flux over town
(  100) REAL, DIMENSION(:)  , INTENT(OUT)   :: PGFLX_TWN         ! flux through the ground
(  101) REAL, DIMENSION(:)  , INTENT(OUT)   :: PEVAP_TWN         ! evaporation flux (kg/m2/s)
(  102) REAL, DIMENSION(:)  , INTENT(OUT)   :: PSFCO2            ! flux of CO2       (m/s*kg_CO2/kg_air)
(  103) REAL, DIMENSION(:)  , INTENT(OUT)   :: PUW_GRND          ! momentum flux for ground built surf
(  104) REAL, DIMENSION(:)  , INTENT(OUT)   :: PUW_RF            ! momentum flux for roofs
(  105) REAL, DIMENSION(:)  , INTENT(OUT)   :: PDUWDU_GRND       !
(  106) REAL, DIMENSION(:)  , INTENT(OUT)   :: PDUWDU_RF         !
(  107) REAL, DIMENSION(:)  , INTENT(OUT)   :: PUSTAR_TWN        ! friciton velocity over town
(  108) REAL, DIMENSION(:)  , INTENT(OUT)   :: PCD               ! town averaged drag coefficient
(  109) REAL, DIMENSION(:)  , INTENT(OUT)   :: PCDN              ! town averaged neutral drag coefficient
(  110) REAL, DIMENSION(:)  , INTENT(OUT)   :: PCH_TWN           ! town averaged heat transfer coefficient
(  111) REAL, DIMENSION(:)  , INTENT(OUT)   :: PRI_TWN           ! town averaged Richardson number
(  112) REAL, DIMENSION(:)  , INTENT(OUT)   :: PTS_TWN           ! town surface temperature
(  113) REAL, DIMENSION(:)  , INTENT(OUT)   :: PEMIS_TWN         ! town equivalent emissivity
(  114) REAL, DIMENSION(:)  , INTENT(OUT)   :: PDIR_ALB_TWN      ! town equivalent direct albedo
(  115) REAL, DIMENSION(:)  , INTENT(OUT)   :: PSCA_ALB_TWN      ! town equivalent diffuse albedo






NVFORTRAN (Version     23.1)          02/24/2023  13:58:10      page 7

(  116) REAL, DIMENSION(:)  , INTENT(OUT)   :: PRESA_TWN         ! town aerodynamical resistance
(  117) REAL, DIMENSION(:)  , INTENT(OUT)   :: PAC_RD            ! road conductance
(  118) REAL, DIMENSION(:)  , INTENT(OUT)   :: PAC_GD            ! green area conductance
(  119) REAL, DIMENSION(:)  , INTENT(OUT)   :: PAC_GR            ! green roof conductance
(  120) REAL, DIMENSION(:)  , INTENT(OUT)   :: PAC_RD_WAT        ! road conductance for latent heat
(  121) REAL, DIMENSION(:)  , INTENT(OUT)   :: PAC_GD_WAT        ! green area conductance for latent heat
(  122) REAL, DIMENSION(:)  , INTENT(OUT)   :: PAC_GR_WAT        ! green roof conductance for latent heat
(  123) INTEGER             , INTENT(IN)    :: KDAY               ! Simulation day
(  124) REAL, DIMENSION(:)  , INTENT(OUT)    :: PEMIT_LW_GRND     ! LW flux emitted by the ground (W/m2 ground)
(  125) REAL, DIMENSION(:)  , INTENT(OUT)    :: PEMIT_LW_FAC      ! LW flux emitted by the facade (W/m2 ground)
(  126) REAL, DIMENSION(:)  , INTENT(OUT)    :: PT_RAD_IND        ! Indoor mean radiant temperature [K]
(  127) REAL, DIMENSION(:)  , INTENT(OUT)    :: PREF_SW_GRND      ! total solar rad reflected from ground
(  128) REAL, DIMENSION(:)  , INTENT(OUT)    :: PREF_SW_FAC       ! total solar rad reflected from facade
(  129) REAL, DIMENSION(:)  , INTENT(OUT)    :: PHU_BLD           ! Indoor relative humidity 0 < (-) < 1
(  130) REAL                , INTENT(IN)     :: PTIME             ! current time since midnight (UTC, s)
(  131) REAL, DIMENSION(:),   INTENT(OUT)     :: PPROD_BLD        ! Averaged     Energy production of solar panel on roofs (W/m2 bld  )
(  132) END SUBROUTINE TEB_GARDEN
(  133) # 134 "modi_teb_garden.F90"
(  134) END INTERFACE
(  135) END MODULE MODI_TEB_GARDEN 
