! ----------------------------------------------------------

REAL(KIND=JPRB)         :: ZSTP=2.5066282746310005
REAL(KIND=JPRB), DIMENSION(6)   :: ZCOEF=(/ 76.18009172947146,-86.50532032941677,24.01409824083091, &
       &          -1.231739572450155,0.1208650973866179E-2,-0.5395239384953E-5 /)
REAL(KIND=JPRB)         :: ZSERCST=1.000000000190015
REAL(KIND=JPRB)         :: ZGAMMA, RFCGAMMA, MOMG

REAL(KIND=JPRB)         :: PALPHA,PNU,PP,ZPX,ZSER,ZTTMMP,ZTMP,ZX,ZY



!ZCOEF(1) = 76.18009172947146
!ZCOEF(2) =-86.50532032941677
!ZCOEF(3) = 24.01409824083091
!ZCOEF(4) = -1.231739572450155
!ZCOEF(5) =  0.1208650973866179E-2
!ZCOEF(6) = -0.5395239384953E-5
!ZSTP     =  2.5066282746310005
!ZSERCST = 1.000000000190015


   ZX(ZPX) = (1._JPRB-ZPX)*(1._JPRB-MAX(SIGN(1._JPRB,ZPX),0._JPRB)) & 
  &   + ZPX*MAX(SIGN(1._JPRB,ZPX),0._JPRB)   
ZY(ZPX) = ZX(ZPX)
ZTTMMP(ZPX) =  ZX(ZPX) + 5.5
ZTMP(ZPX) = (ZX(ZPX) + 0.5)*LOG(ZTTMMP(ZPX)) - ZTTMMP(ZPX)


    ZSER(ZPX) = ZSERCST + ZCOEF(1)/(1.+ZY(ZPX)) + ZCOEF(2)/(2.+ZY(ZPX)) &
   &     + ZCOEF(3)/(3.+ZY(ZPX)) + ZCOEF(4)/(4.+ZY(ZPX)) &   
   &     + ZCOEF(5)/(5.+ZY(ZPX)) + ZCOEF(6)/(6.+ZY(ZPX))

   ZGAMMA(ZPX) = EXP( ZTMP(ZPX) + LOG( ZSTP*ZSER(ZPX)/ZX(ZPX) ) )
   RFCGAMMA(ZPX) = ZGAMMA(ZPX) * MAX(SIGN(1._JPRB,ZPX),0._JPRB) &
    &                    + (RPI/SIN(RPI*ZPX)/ZGAMMA(ZPX))         &
    &                    *(1._JPRB-MAX(SIGN(1._JPRB,ZPX),0._JPRB))

   MOMG(PALPHA,PNU,PP) = RFCGAMMA(PNU+PP/PALPHA)/RFCGAMMA(PNU)
